<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>
  <script>
    function newNode(_key){
      let key = _key;
      let left = null;
      let right = null;

      return {key, left, right};
    }

    function Tree(array){
      let raw = array;
      let root = null;

      const insert = (value, currentNode) => {
        if(root === null){
          root = newNode(value);
          return;
        }
        else if(value === currentNode.key){return;}
        else if(value < currentNode.key){
          if(currentNode.left === null){currentNode.left = newNode(value);}
          else insert(value, currentNode.left);
        }
        else if(value > currentNode.key){
          if(currentNode.right === null){currentNode.right = newNode(value)}
          else insert(value, currentNode.right);
        }
      }

      //build the initial tree:
      raw.forEach(value => {
        insert(value, root);
      });

      const deleteItem = (value, currentNode, previousNode = null) => {
        //iterate until finding the value:
        if(currentNode === null) return test.prettyPrint(test.getRoot());;
        if(value < currentNode.key){
          deleteItem(value,currentNode.left, currentNode);
          return;
        }
        if(value > currentNode.key){
          deleteItem(value,currentNode.right, currentNode);
          return;
        }

        //Run deletion:
        if(value === currentNode.key){
          let isLeftChild;
          (currentNode.key < previousNode.key) ? isLeftChild = true : isLeftChild = false; //determine which child the deletion node is

          //if leaf:
          if(currentNode.left === null && currentNode.right === null){
            isLeftChild ? previousNode.left = null : previousNode.right = null;
            return test.prettyPrint(test.getRoot());
          }

          //one child:
          if(currentNode.left !== null && currentNode.right === null){
            isLeftChild ? previousNode.left = currentNode.left : previousNode.right = currentNode.left;
            return test.prettyPrint(test.getRoot());
          }
          if(currentNode.left === null && currentNode.right !== null){
            isLeftChild ? previousNode.left = currentNode.right : previousNode.right = currentNode.right;
            return test.prettyPrint(test.getRoot());
          }

          //two childs the doozy:
          if(currentNode.left !== null && currentNode.right !== null){
            console.log('yep');
            let replacementNode = currentNode.right;
            console.log(replacementNode)
            while(replacementNode.left !== null){
              replacementNode = replacementNode.left; 
            }
            console.log(replacementNode)
            let rightBranchHolder = replacementNode.right;
            replacementNode.left = currentNode.left;
            replacementNode.right = currentNode.right;
            deleteItem(replacementNode.key, replacementNode.right, replacementNode); //SOMETHING IS WEIRD HERE delete the replacement's original spot
            isLeftChild ? previousNode.left = replacementNode : previousNode.right = replacementNode; //Append final
            return test.prettyPrint(test.getRoot());
          }
        }
      }

      /*
      replacement logic:
      1. find the node that will replace the deletion node (the left most node of the right branch)
          -copy that node to be worked on
      2. copy the deletion node's left branch to be the replacement node's left branch
      3. copy the deletion node's right branch to be the replacement node's right branch
      4. fix the replacement node's original location to be null or it's original right branch
      */

      //Odin gave me this to view the tree:
      const prettyPrint = (node, prefix = "", isLeft = true) => {
        if (node === null) {
          return;
        }
        if (node.right !== null) {
          prettyPrint(node.right, `${prefix}${isLeft ? "│   " : "    "}`, false);
        }
        console.log(`${prefix}${isLeft ? "└── " : "┌── "}${node.key}`);
        if (node.left !== null) {
          prettyPrint(node.left, `${prefix}${isLeft ? "    " : "│   "}`, true);
        }
      };

      
      const getRoot = () => {return root;}

      return {insert, deleteItem, prettyPrint, getRoot}
    }

    

    test = Tree([9, 7, 4, 23, 8, 9, 4, 3, 5, 7, 9, 67, 6345, 324, 34, 54, 21, 23, 45, 76, 56, 54, 32, 35, 25, 22, 21, 32, 36]);
    test.prettyPrint(test.getRoot())
  </script>  
</body>
</html>
